<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì• ë‹ˆë©”ì´ì…˜ ìˆ˜ì§‘ê¸° (ì‹¬í”Œ ë²„ì „)</title>
  <style>
    body { font-family: 'Pretendard', sans-serif; padding: 20px; background: #f5f7fa; color: #333; }
    .container { max-width: 1000px; margin: 0 auto; display: grid; grid-template-columns: 1fr 1.5fr; gap: 20px; }
    .section { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
    h3 { margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px; }
    .search-input { width: calc(100% - 24px); padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px; margin-bottom: 10px; }
    .btn-search { width: 100%; background: #4a5568; color: white; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-bottom: 20px; }
    .search-item { display: flex; gap: 12px; padding: 10px; border-bottom: 1px solid #edf2f7; cursor: pointer; align-items: center; }
    .search-item:hover { background: #f7fafc; }
    .search-item img { width: 45px; height: 63px; border-radius: 4px; object-fit: cover; }
    .preview-header { display: flex; gap: 20px; margin-bottom: 20px; }
    .preview-header img { width: 140px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    #codeOutput { width: 100%; height: 250px; font-family: 'Fira Code', monospace; background: #1a202c; color: #e2e8f0; padding: 15px; border-radius: 8px; border: none; box-sizing: border-box; }
    .btn-copy { width: 100%; background: #38a169; color: white; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px; }
  </style>
</head>
<body>

<div class="container">
  <div class="section">
    <h3>ğŸ” ì• ë‹ˆë©”ì´ì…˜ ê²€ìƒ‰</h3>
    <input type="text" id="query" class="search-input" placeholder="ì¼ë³¸ì–´ ë˜ëŠ” ì˜ì–´ ì œëª© ì…ë ¥" onkeypress="if(event.keyCode==13) searchAnime()">
    <button class="btn-search" onclick="searchAnime()">ê²€ìƒ‰</button>
    <div id="status" style="font-size: 13px; color: #3182ce; margin-bottom: 10px;"></div>
    <div id="searchResult"></div>
  </div>

  <div class="section">
    <h3>ğŸ“„ ì¶”ì¶œ ë°ì´í„° (ì¥ë¥´ ì œì™¸)</h3>
    <div id="preview" style="display:none;">
      <div class="preview-header">
        <img id="p-img" src="">
        <div class="info">
          <h4 id="p-title" style="margin:0 0 5px 0;"></h4>
          <p id="p-title-jp" style="font-size:13px; color:#718096; margin:0 0 10px 0;"></p>
          <div style="font-size: 13px; line-height: 1.6;">
            <b>ID:</b> <span id="p-id"></span> | <b>ìš”ì¼:</b> <span id="p-day"></span><br>
            <b>í™”ìˆ˜:</b> <span id="p-eps"></span>í™” | <b>ì œì‘ì‚¬:</b> <span id="p-studio"></span>
          </div>
        </div>
      </div>
      <textarea id="codeOutput" readonly></textarea>
      <button class="btn-copy" onclick="copyCode()">ì½”ë“œ ë³µì‚¬í•˜ê¸°</button>
    </div>
  </div>
</div>

<script>
  async function searchAnime() {
    const query = document.getElementById('query').value;
    const resultDiv = document.getElementById('searchResult');
    const status = document.getElementById('status');
    if(!query) return;
    status.innerText = "ğŸ” ê²€ìƒ‰ ì¤‘...";
    try {
      const resp = await fetch(`https://api.jikan.moe/v4/anime?q=${encodeURIComponent(query)}&limit=8`);
      const json = await resp.json();
      resultDiv.innerHTML = json.data.map(anime => `
        <div class="search-item" onclick="getAnimeDetail(${anime.mal_id})">
          <img src="${anime.images.jpg.image_url}">
          <div>
            <div style="font-weight:bold; font-size:14px;">${anime.title}</div>
            <div style="font-size:12px; color:#718096;">${anime.title_japanese || ''}</div>
          </div>
        </div>
      `).join('');
      status.innerText = `âœ… ê²€ìƒ‰ ì™„ë£Œ`;
    } catch (e) { status.innerText = "âŒ ê²€ìƒ‰ ì—ëŸ¬"; }
  }

  async function getAnimeDetail(id) {
    try {
      const resp = await fetch(`https://api.jikan.moe/v4/anime/${id}`);
      const json = await resp.json();
      const data = json.data;

      // ì¥ë¥´(genres) í•„ë“œë¥¼ ì œì™¸í•œ ê°ì²´ ìƒì„±
      const animeObj = {
        id: data.mal_id,
        title: data.title, 
        thumbnail: data.images.jpg.large_image_url,
        day: data.broadcast.day || "Unknown",
        episodes: data.episodes || 0,
        studio: data.studios.length > 0 ? data.studios[0].name : "Unknown"
      };

      document.getElementById('preview').style.display = "block";
      document.getElementById('p-img').src = animeObj.thumbnail;
      document.getElementById('p-title').innerText = animeObj.title;
      document.getElementById('p-title-jp').innerText = data.title_japanese || '';
      document.getElementById('p-id').innerText = animeObj.id;
      document.getElementById('p-day').innerText = animeObj.day;
      document.getElementById('p-eps').innerText = animeObj.episodes;
      document.getElementById('p-studio').innerText = animeObj.studio;

      document.getElementById('codeOutput').value = JSON.stringify(animeObj, null, 2) + ",";
    } catch (e) { alert("ìƒì„¸ ì •ë³´ ì—ëŸ¬"); }
  }

  function copyCode() {
    const area = document.getElementById('codeOutput');
    area.select();
    document.execCommand('copy');
    alert("ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
  }
</script>
</body>
</html>