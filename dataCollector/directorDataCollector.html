<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Director Data Extractor</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; padding: 30px; background-color: #f0f2f5; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 8px 16px rgba(0,0,0,0.1); }
        h2 { color: #1a73e8; border-bottom: 2px solid #1a73e8; padding-bottom: 10px; }
        #output { 
            background: #1e1e1e; color: #d4d4d4; padding: 20px; border-radius: 8px; 
            white-space: pre-wrap; font-family: 'Consolas', monospace; font-size: 14px;
            max-height: 600px; overflow-y: auto; border: 1px solid #333;
        }
        .btn-group { margin-bottom: 15px; }
        .btn { 
            padding: 12px 20px; background: #1a73e8; color: white; border: none; 
            cursor: pointer; border-radius: 6px; font-weight: bold; transition: 0.3s;
        }
        .btn:hover { background: #1557b0; }
    </style>
</head>
<body>
    <div class="container">
        <h2>ğŸš€ ê°ë… ë°ì´í„° ë³€í™˜ ë„êµ¬ (JS íŒŒì¼ìš©)</h2>
        <p>ì•„ë˜ í…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•´ì„œ <code>../data/animeDirectorData.js</code> íŒŒì¼ì— ì €ì¥í•˜ì„¸ìš”.</p>
        <div class="btn-group">
            <button class="btn" onclick="copyToClipboard()">ì „ì²´ ì½”ë“œ ë³µì‚¬í•˜ê¸°</button>
        </div>
        <div id="output">ë°ì´í„°ë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</div>
    </div>

    <script src="../data/animeData.js"></script>

    <script>
        function generateJSFileContent() {
            if (typeof AnimeByQuarter === 'undefined') {
                return "ì—ëŸ¬: animeData.jsë¥¼ ì°¾ì„ ìˆ˜ ì—†ê±°ë‚˜ ë°ì´í„° êµ¬ì¡°ê°€ ë‹¤ë¦…ë‹ˆë‹¤.";
            }

            const allAnimes = Object.values(AnimeByQuarter).flat();
            const directorMap = {};

            allAnimes.forEach(anime => {
                // staff ë° director ì¡´ì¬ ì—¬ë¶€ ì•ˆì „í•˜ê²Œ í™•ì¸
                const directors = anime.staff?.director;
                
                if (directors && Array.isArray(directors)) {
                    directors.forEach(dirName => {
                        if (!dirName) return;

                        if (!directorMap[dirName]) {
                            directorMap[dirName] = {
                                director: dirName,
                                director_img: `../image/staff/director/${dirName}.webp`, 
                                works: []
                            };
                        }

                        // studio ì œì™¸, title/thumbnailë§Œ ì¶”ì¶œ
                        directorMap[dirName].works.push({
                            title: anime.title,
                            thumbnail: `../${anime.thumbnail}`
                        });
                    });
                }
            });

            const finalArray = Object.values(directorMap);
            // JS ë³€ìˆ˜ ì„ ì–¸ë¬¸ì„ í¬í•¨í•œ ë¬¸ìì—´ ìƒì„±
            return `const animeDirectorData = ${JSON.stringify(finalArray, null, 2)};`;
        }

        // ê²°ê³¼ ì¶œë ¥
        const finalCode = generateJSFileContent();
        document.getElementById('output').textContent = finalCode;

        function copyToClipboard() {
            const text = document.getElementById('output').textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert("ì½”ë“œ ì „ì²´ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! animeDirectorData.js íŒŒì¼ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.");
            });
        }
    </script>
</body>
</html>